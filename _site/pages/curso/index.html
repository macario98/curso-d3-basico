<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Visualización de datos con D3</title>

    <link href="/assets/css/main.css" rel="stylesheet">

    <script src="/bower_components/d3/d3.min.js" charset="utf8"></script>

  </head>
  <body>

    <div class="container">
      <h1>Visualización de Datos con D3</h1>

<h2>Manipulación del DOM con D3</h2>

<p>Podemos usar D3 para manipular elementos del DOM (Document Object Model). Por ejemplo, podemos cambiar el color de fondo de un contenedor.</p>

<div>
    <style>
        #block-container {
            display: inline-block;
        }

        .block {
            float: left;
            margin: 20px;
            width: 100px;
            height: 50px;
        }

        #red {
            background-color: red;
        }

        #blue {
            background-color: blue;
        }
    </style>
</div>




<div id='block-container'>
    <div class="block" id="red"></div>
    <div class="block" id="blue"></div>
</div>


<p>Podemos cambiar el color de fondo de un contenedor</p>

<pre><code>d3.select('#red').style('background-color', 'green');
</code></pre>

<p>o podemos cambiar varios elementos al mismo tiempo, seleccionando por clase o por tipo de elemento</p>

<pre><code>d3.selectAll('.block').style('width', '100px');
</code></pre>

<p>DIY:</p>

<ul>
<li>Cambiar la altura del contenedor azul.</li>
<li>Alinear los contenedores a la derecha.</li>
<li>Escribir algo dentro de un contenedor.</li>
</ul>


<p>Podemos agregar elementos</p>

<div class="ejemplo">
    <div id="ejemplo02"></div>
</div>


<p>Agregar un elemento <code>SVG</code> en el contenedor <code>#ejemplo02</code>.</p>

<pre><code>var svg = d3.select('#ejemplo02').append('svg');
</code></pre>

<p>La variable <code>svg</code> contiene una referencia al elemento creado. Podemos usar esta referencia para cambiar los atributos del elemento.</p>

<pre><code>svg.attr('width', 300).attr('height', 100);
</code></pre>

<p>Podemos agregar un rectángulo al SVG:</p>

<pre><code>var rect = svg.append('rect')
    .attr('fill', 'blue')
    .attr('x', 20)
    .attr('y', 20)
    .attr('width', 150)
    .attr('height', 80);
</code></pre>

<p>DIY:</p>

<ul>
<li>Agregar un circulo <code>&lt;circle cx=10 cy=10 r=30 fill='#bababa'&gt;&lt;/circle&gt;</code></li>
<li>También se pueden eliminar elementos del DOM. Por ejemplo, se puede borrar el rectángulo con <code>rect.remove()</code>.</li>
</ul>


<h2>Data Binding</h2>

<p>El DOM se puede manipular con varias librerías, por ejemplo, con jQuery. La diferencia con D3, es que los elementos del DOM se pueden asociar a elementos de un array de datos.</p>

<div class="ejemplo">
    <svg id="ejemplo03" width=400 height=200></svg>
</div>


<p>Y buen como iba diciendo...</p>

<pre><code>var svg = d3.select('#ejemplo03');

var data = [
    {ancho: 100, color: 'blue'},
    {ancho:  80, color: 'red'},
    {ancho:  60, color: 'yellow'},
    {ancho: 140, color: 'green'}
];

var rect = svg.selectAll('rect').data(data);

rect.enter().append('rect')
    .attr('y', function(d, i) { return 50 * i; })
    .attr('width', function(d) { return d.ancho; })
    .attr('height', 40)
    .attr('fill', function(d) { return d.color; });
</code></pre>

<p>Se pueden actualizar los atributos de los rectángulos</p>

<pre><code>rect.attr('x', 100);
</code></pre>

<p>Si hacemos binding de la misma selección con otro arreglo de datos, los elementos del DOM que tienen datos asociados se actualizan, y los que no, se eliminan. Si hay elementos de dato que no tienen elemento del DOM asociado, se agregan.</p>

<div class="ejemplo">
    <svg id="ejemplo04" width=400 height=200></svg>
</div>


<p>Por ejemplo:</p>

<pre><code>var svg = d3.select('#ejemplo04');

var data = [
    {ancho: 100, color: 'blue'},
    {ancho:  80, color: 'red'},
];

var rect = svg.selectAll('rect').data(data);

// Nuevos rectangulos
rect.enter().append('rect')
    .attr('x', 0)
    .attr('y', function(d, i) { return 50 * i; })
    .attr('width', function(d) { return d.ancho; })
    .attr('height', 40)
    .attr('fill', 'blue');

// Update
rect.transition().duration(1000)
    .attr('x', 100)
    .attr('fill', function(d) { return d.color; });

// Remove
rect.exit().transition().duration(1000)
    .attr('x', 500)
    .attr('fill', 'black')
    .remove();
</code></pre>

<p>El binding entre elementos graficos y propiedades de los graficos permite crear gráficos y visualizaciones de datos.</p>

    </div>
  </body>
</html>